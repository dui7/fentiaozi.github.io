(window.webpackJsonp=window.webpackJsonp||[]).push([[25],{416:function(e,s,a){"use strict";a.r(s);var t=a(17),r=Object(t.a)({},(function(){var e=this,s=e.$createElement,a=e._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[a("h1",{attrs:{id:"部署minikube"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#部署minikube"}},[e._v("#")]),e._v(" 部署minikube")]),e._v(" "),a("p",[e._v("github地址\n"),a("a",{attrs:{href:"https://github.com/easzlab/kubeasz/blob/master/docs/setup/quickStart.md",target:"_blank",rel:"noopener noreferrer"}},[e._v("easzlab快速开始"),a("OutboundLink")],1)]),e._v(" "),a("h2",{attrs:{id:"快速指南"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#快速指南"}},[e._v("#")]),e._v(" 快速指南")]),e._v(" "),a("p",[e._v("以下为快速体验k8s集群的测试、开发环境--单节点部署(aio)，国内环境下比官方的minikube方便、简单很多。")]),e._v(" "),a("h3",{attrs:{id:"_1-基础系统配置"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-基础系统配置"}},[e._v("#")]),e._v(" 1.基础系统配置")]),e._v(" "),a("ul",[a("li",[e._v("准备一台虚机配置内存2G/硬盘30G以上")]),e._v(" "),a("li",[e._v("最小化安装"),a("code",[e._v("Ubuntu 16.04 server")]),e._v("或者"),a("code",[e._v("CentOS 7 Minimal")])]),e._v(" "),a("li",[e._v("配置基础网络、更新源、SSH登录等")])]),e._v(" "),a("p",[a("strong",[e._v("注意:")]),e._v(" 确保在干净的系统上开始安装，不能使用曾经装过kubeadm或其他k8s发行版的环境，用root账号执行下面命令。")]),e._v(" "),a("h3",{attrs:{id:"_2-下载文件"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-下载文件"}},[e._v("#")]),e._v(" 2.下载文件")]),e._v(" "),a("ul",[a("li",[e._v("下载工具脚本ezdown，举例使用kubeasz版本3.0.0")])]),e._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[e._v("export")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[e._v("release")]),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[e._v("3.0")]),e._v(".0\n"),a("span",{pre:!0,attrs:{class:"token function"}},[e._v("curl")]),e._v(" -C- -fLO --retry "),a("span",{pre:!0,attrs:{class:"token number"}},[e._v("3")]),e._v(" https://github.com/easzlab/kubeasz/releases/download/"),a("span",{pre:!0,attrs:{class:"token variable"}},[e._v("${release}")]),e._v("/ezdown\n"),a("span",{pre:!0,attrs:{class:"token function"}},[e._v("chmod")]),e._v(" +x ./ezdown\n")])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br"),a("span",{staticClass:"line-number"},[e._v("2")]),a("br"),a("span",{staticClass:"line-number"},[e._v("3")]),a("br")])]),a("ul",[a("li",[e._v("使用工具脚本下载")])]),e._v(" "),a("p",[e._v("默认下载最新推荐k8s/docker等版本（更多关于ezdown的参数，运行./ezdown 查看）")]),e._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[e._v("./ezdown -D\n")])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br")])]),a("ul",[a("li",[e._v("可选下载离线系统包 (适用于无法使用yum/apt仓库情形)")])]),e._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[e._v("./ezdown -P\n")])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br")])]),a("p",[e._v("上述脚本运行成功后，所有文件（kubeasz代码、二进制、离线镜像）均已整理好放入目录"),a("code",[e._v("/etc/kubeasz")])]),e._v(" "),a("ul",[a("li",[a("code",[e._v("/etc/kubeasz")]),e._v(" 包含 kubeasz 版本为 ${release} 的发布代码")]),e._v(" "),a("li",[a("code",[e._v("/etc/kubeasz/bin")]),e._v(" 包含 k8s/etcd/docker/cni 等二进制文件")]),e._v(" "),a("li",[a("code",[e._v("/etc/kubeasz/down")]),e._v(" 包含集群安装时需要的离线容器镜像")]),e._v(" "),a("li",[a("code",[e._v("/etc/kubeasz/down/packages")]),e._v(" 包含集群安装时需要的系统基础软件")])]),e._v(" "),a("h3",{attrs:{id:"_3-安装集群"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-安装集群"}},[e._v("#")]),e._v(" 3.安装集群")]),e._v(" "),a("ul",[a("li",[e._v("容器化运行 kubeasz，详见ezdown 脚本中的 start_kubeasz_docker 函数")])]),e._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("./ezdown -S\n")])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br")])]),a("ul",[a("li",[e._v("使用默认配置安装 aio 集群")])]),e._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("docker exec -it kubeasz ezctl start-aio\n")])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br")])]),a("h3",{attrs:{id:"_4-验证安装"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4-验证安装"}},[e._v("#")]),e._v(" 4.验证安装")]),e._v(" "),a("p",[e._v("如果提示kubectl: command not found，退出重新ssh登录一下，环境变量生效即可")]),e._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[e._v("$ kubectl version         "),a("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# 验证集群版本     ")]),e._v("\n$ kubectl get node        "),a("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# 验证节点就绪 (Ready) 状态")]),e._v("\n$ kubectl get pod -A      "),a("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# 验证集群pod状态，默认已安装网络插件、coredns、metrics-server等")]),e._v("\n$ kubectl get svc -A      "),a("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# 验证集群服务状态")]),e._v("\n")])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br"),a("span",{staticClass:"line-number"},[e._v("2")]),a("br"),a("span",{staticClass:"line-number"},[e._v("3")]),a("br"),a("span",{staticClass:"line-number"},[e._v("4")]),a("br")])]),a("ul",[a("li",[e._v("登录 "),a("code",[e._v("dashboard")]),e._v("可以查看和管理集群，更多内容请查阅"),a("RouterLink",{attrs:{to:"/nav.50.运维/guide/dashboard.html"}},[e._v("dashboard文档")])],1)]),e._v(" "),a("h3",{attrs:{id:"_5-清理"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_5-清理"}},[e._v("#")]),e._v(" 5.清理")]),e._v(" "),a("p",[e._v("以上步骤创建的K8S开发测试环境请尽情折腾，碰到错误尽量通过查看日志、上网搜索、提交"),a("code",[e._v("issues")]),e._v("等方式解决；当然你也可以清理集群后重新创建。")]),e._v(" "),a("p",[e._v("在宿主机上，按照如下步骤清理")]),e._v(" "),a("ul",[a("li",[e._v("清理集群 "),a("code",[e._v("docker exec -it kubeasz ezctl destroy default")])]),e._v(" "),a("li",[e._v("清理运行的容器 "),a("code",[e._v("./ezdown -C")])]),e._v(" "),a("li",[e._v("清理容器镜像 "),a("code",[e._v("docker system prune -a")])]),e._v(" "),a("li",[e._v("停止docker服务 "),a("code",[e._v("systemctl stop docker")])]),e._v(" "),a("li",[e._v("删除docker文件")])]),e._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v(" umount /var/run/docker/netns/default\n umount /var/lib/docker/overlay\n rm -rf /var/lib/docker /var/run/docker\n")])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br"),a("span",{staticClass:"line-number"},[e._v("2")]),a("br"),a("span",{staticClass:"line-number"},[e._v("3")]),a("br")])]),a("p",[e._v("上述清理脚本执行成功后，建议重启节点，以确保清理残留的虚拟网卡、路由等信息。")])])}),[],!1,null,null,null);s.default=r.exports}}]);